<div data-section-id="{{ section.id }}" data-section-type="product" data-enable-history-state="true" itemscope itemtype="http://schema.org/Product">
  {%- assign current_variant = product.selected_or_first_available_variant -%}
  {%- assign featured_image = current_variant.featured_image | default: product.featured_image -%}
  <meta itemprop="name" content="{{ product.title }}{% unless product.has_only_default_variant %} - {{ current_variant.title }}{% endunless %}">
  <meta itemprop="url" content="{{ shop.url }}{{ current_variant.url }}">
  <meta itemprop="brand" content="{{ product.vendor }}">
  <meta itemprop="image" content="{{ featured_image | img_url: '600x600' }}">
  <meta itemprop="description" content="{{ product.description | strip_html | escape }}">
  <div class="product--container">
    <div data-animation="slide" data-duration="500" data-infinite="1" class="mobile--slider w-slider">
      <div class="w-slider-mask">
        <div class="mobile--slider--slide w-slide">
          <div class="mobile--pocket--block">
            <img src="images/lagrossevie_thumbnail_grande.png" width="60" height="60" />
          </div>
        </div>
        <div class="w-slide"></div>
      </div>
      <div class="mobile--slider--arrows w-slider-arrow-left">
        <div class="w-icon-slider-left"></div>
      </div>
      <div class="mobile--slider--arrows w-slider-arrow-right">
        <div class="w-icon-slider-right"></div>
      </div>
      <div class="w-slider-nav w-round"></div>
    </div>
    <div class="breadcrumbs">
      <a href="#" class="link">{{product.type}} / {{product.collection}} /</a>
    </div>
    <div class="product--block">
      <div class="product--block--left images--block">
        <div class="product--image--smaller">
          <a href="#" class="product--image--smaller--item w-inline-block">
            <img src="https://d3e54v103j8qbb.cloudfront.net/img/image-placeholder.svg">
          </a>
          <a href="#" class="product--image--smaller--item w-inline-block">
            <img src="https://d3e54v103j8qbb.cloudfront.net/img/image-placeholder.svg">
          </a>
          <a href="#" class="product--image--smaller--item w-inline-block">
            <img src="https://d3e54v103j8qbb.cloudfront.net/img/image-placeholder.svg">
          </a>
        </div>
        <div class="product--image--large">
          <img class="product--pocket--image--placement--man product-preview"  width="50" height="50"/></div>
      </div>
      <div class="product--block--right">
        <div class="product--variant--image">
          <div class="product--variant--image--image">
            <img class="product--variant--image--image product-preview"  />
          </div>
          <div>
            <h2 class="product--variant--price">
              {{ shop.currency }}
              <span class="product--variant--price-amount">
                {{ product.price | money }}
              </span>
            </h2>
            <strong><span class="product--VA--name no-wrap">{{ product.title }}</span></strong>
            <br>
            <span class="product--VA--desc">{{ product.description }}</span>
          </div>
        </div>
        {%- comment -%}Including full product form.{%- endcomment -%}
        {% include 'product--form' %}
        {% include 'product-toggle' %}   
      </div>
    </div>
    {% include 'related--products' %}
  </div>

  {% unless product == empty %}
  <script type="application/json" data-product-json>{{ product | json }}</script>
  {% endunless %}
</div>

<script>
  (function () {
    const getModels = (event, searchColor) => {
      /*
       * urlParams are sent to getRandImg() as an array.
       * e.g. ['adult=true', 'genre=female', 'type=...']
       * if no urlParams are found, it sends `false`
      */
      const urlParams 		= getProductUrlparams(window.location.href)
      if(searchColor) {
        urlParams.push(`&color=${searchColor.toLowerCase()}`)
      }
      
      const modelImageUrl	= getRandImg(urlParams)
      const modelThumbs		= getRandImg(urlParams, 'getArray')
      const modelContainer	= $('.product--image--large')

      if (modelImageUrl && modelThumbs) {
        const modelThumbsContainer = $(document).find('.product--image--smaller').empty()

        modelContainer
        .attr('style', `background-image: url('${modelImageUrl}')`)
        .find('img')
        .css('transform', `translateY(${modelImageUrl.includes('--Kid') ? '70px':'0'})`)

        modelThumbs.map((thumb, index) => {
          const modelThumb = `<img src="${thumb}" class="model-thumb"/>`
          if (index < 10) {
            modelThumbsContainer.append(modelThumb)
          }
        }) 
      }
    }

    const setPreviewImage = event => {
      const selectedModel = $(event.target)[0].src
      $('.product--image--large')
      .css('background-image', `url('${selectedModel}')`)
      .find('img')
      .css('transform', `translateY(${selectedModel.includes('Kid') ? '70px':'0'})`)
    }

    const filterColors = event => getModels(false, $(event.target).attr('title'))

    $(document).ready(getModels)
    $(document).on('click', 'li[title]', filterColors)
    $(document).on('click', 'img.model-thumb', setPreviewImage)
  })()
</script>

<style>
  .model-thumb { cursor: pointer }
</style>

{% schema %}
{
"name": "Product pages",
"settings": [
{
"type": "checkbox",
"id": "show_share_buttons",
"label": "Show social sharing buttons",
"default": true
}
]
}
{% endschema %}
